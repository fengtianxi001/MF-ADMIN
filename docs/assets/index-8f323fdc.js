import{B as K}from"./index-01b07792.js";import{d as C,g as O,c as _,i as W,_ as A,o as y,a as $,n as H,b as q,e as w,r as b,l as k,w as Q,f as T,h as c,m as D,u as s,T as G,j as U,P as J,k as X,F as Z,p as z,q as N,s as x,I as ee,t as V,v as te,x as S,M as ae,y as ne,z as j,A as oe,B as se}from"./index-d074fa50.js";import{u as L}from"./index-93b71ab6.js";import{_ as E,a as le,M as F}from"./index.vue_vue_type_script_setup_true_lang-9929fb72.js";import{g as re,u as ie,a as ce,_ as M,b as ue}from"./index.vue_vue_type_script_setup_true_lang-203d5e18.js";import{u as de,B as me}from"./index-ae32e563.js";import{u as pe}from"./index-cc7dd6ae.js";const fe=C({name:"IconRefresh",props:{size:{type:[Number,String]},strokeWidth:{type:Number,default:4},strokeLinecap:{type:String,default:"butt",validator:e=>["butt","round","square"].includes(e)},strokeLinejoin:{type:String,default:"miter",validator:e=>["arcs","bevel","miter","miter-clip","round"].includes(e)},rotate:Number,spin:Boolean},setup(e){const a=O("icon"),o=_(()=>[a,`${a}-refresh`,{[`${a}-spin`]:e.spin}]),l=_(()=>{const t={};return e.size&&(t.fontSize=W(e.size)?`${e.size}px`:e.size),e.rotate&&(t.transform=`rotate(${e.rotate}deg)`),t});return{cls:o,innerStyle:l}}}),ge=["stroke-width","stroke-linecap","stroke-linejoin"],_e=w("path",{d:"M38.837 18C36.463 12.136 30.715 8 24 8 15.163 8 8 15.163 8 24s7.163 16 16 16c7.455 0 13.72-5.1 15.496-12M40 8v10H30"},null,-1),be=[_e];function ye(e,a,o,l,t,i){return y(),$("svg",{viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",stroke:"currentColor",class:H(e.cls),style:q(e.innerStyle),"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},be,14,ge)}var B=A(fe,[["render",ye]]);const ve=Object.assign(B,{install:(e,a)=>{var o;const l=(o=a==null?void 0:a.iconPrefix)!=null?o:"";e.component(l+B.name,B)}});function he(e,a){const o=b(!1),l=b([]),t=b({current:1,size:5,total:0}),i=b(),d=b({});let p;const f=m=>{o.value=!0;const u={...t.value,...d.value,...m};k.isFunction(e)&&e(u).then(n=>{if(a&&k.isFunction(a==null?void 0:a.formmatter)){const{data:r,pagination:g}=a.formmatter(n);r.value=r,t.value=g}else i.value=n.data,t.value={current:n.current,size:n.size,total:n.total};o.value=!1,p&&p(),p=Q(t,()=>f(),{deep:!0})})};return a!=null&&a.manual||f(),{selected:l,loading:o,pagination:t,dataSource:i,search:d,run:f}}const xe=C({__name:"index",props:{pagination:null,selection:{type:Boolean},columns:null},setup(e){const a=e,o=_(()=>{const t={};return a.selection&&(t.rowSelection=T({type:"checkbox",showCheckedAll:!0,onlyCurrent:!1})),t}),l=_(()=>a.columns.map(t=>{const i=t.render;return i&&(t.render=({record:d})=>i(d)),t}));return(t,i)=>(y(),$(Z,null,[c(s(G),D({...t.$attrs,...s(o)},{columns:s(l),pagination:!1,bordered:!1}),null,16,["columns"]),e.pagination?(y(),U(s(J),{key:0,class:"pagination",current:e.pagination.current,"onUpdate:current":i[0]||(i[0]=d=>e.pagination.current=d),"page-size":e.pagination.size,"onUpdate:page-size":i[1]||(i[1]=d=>e.pagination.size=d),total:e.pagination.total,"show-total":!1},null,8,["current","page-size","total"])):X("",!0)],64))}});const ke=z(xe,[["__scopeId","data-v-c085703c"]]),Ce={class:"base-table-filter"},we=C({__name:"index",props:{configs:null,modelValue:null,query:null,grid:null},emits:["update:modelValue"],setup(e,{emit:a}){const o=e,l=b({}),t=b(),{loading:i,openLoading:d,closeLoading:p}=L(!1),{loading:f,openLoading:m,closeLoading:u}=L(!1),n=async()=>{a("update:modelValue",l.value),k.isFunction(o.query)&&(d(),await o.query({current:1}),p())},r=async()=>{t.value.resetFields({}),a("update:modelValue",l.value),k.isFunction(o.query)&&(m(),await o.query({current:1}),u())},g=_(()=>{const v=o.grid||3;return o.configs.length>v?{flexDirection:"column"}:{}}),P=_(()=>({gridTemplateColumns:`repeat(${o.grid||3}, 1fr)`}));return(v,h)=>{const I=N("a-button");return y(),$("div",Ce,[c(E,D({class:"table-filter",modelValue:l.value,"onUpdate:modelValue":h[0]||(h[0]=Y=>l.value=Y),layout:"inline","label-align":"left"},v.$attrs,{ref_key:"formRef",ref:t,configs:e.configs,style:s(P)}),null,16,["modelValue","configs","style"]),w("div",{class:"table-operate",style:q(s(g))},[c(I,{type:"primary",loading:s(i),onClick:n},{icon:x(()=>[c(s(ee))]),default:x(()=>[V("筛选")]),_:1},8,["loading"]),c(I,{loading:s(f),onClick:r},{icon:x(()=>[c(s(ve))]),default:x(()=>[V("重置")]),_:1},8,["loading"])],4)])}}});const $e=z(we,[["__scopeId","data-v-94ae4a08"]]),R=C({__name:"ProjectForm",props:{id:null},setup(e){const a=e,{data:o,run:l,loading:t}=de(re,{manual:!0,defaultParams:[a.id],defaultData:{},formatResult:m=>{var u;return m.principalId=(u=m.principal)==null?void 0:u.id,m}}),{form:i,validate:d}=pe(),p=_(()=>[{name:"name",component:"Input",label:"工程名称",required:!0,formItemProps:{labelColFlex:"100px"}},{name:"principalId",component:"UserPicker",label:"工程负责人"},{name:"code",component:"Input",label:"工程编码"},{name:"type",component:"Select",label:"工程类型",props:{options:[{label:"土木工程",value:"1"},{label:"水利工程",value:"2"}]}},{name:"status",component:"Select",label:"工程状态",props:{options:[{label:"正常",value:1},{label:"异常",value:0}]}},{label:"工程划区",name:"geojson",component:"MapPicker"}]),f=async()=>await d()?!1:(await(a.id?ie:ce)(o.value),ae.success("操作成功"),!0);return te(()=>{a.id&&l()}),(m,u)=>{const n=E,r=le;return y(),U(r,{title:"工程信息表单",width:"500px",onBeforeConfirm:f,loading:s(t)},{default:x(()=>[c(n,{ref_key:"form",ref:i,modelValue:s(o),"onUpdate:modelValue":u[0]||(u[0]=g=>S(o)?o.value=g:null),size:"small",configs:s(p),loading:s(t)},null,8,["modelValue","configs","loading"])]),_:1},8,["loading"])}}}),Pe=e=>{ne.confirm({modalClass:"confirm-modal",...e})},Be={class:"project-profile"},Se={class:"info"},ze={class:"name"},Ie={class:"desc"},Ve=C({__name:"ProjectProfile",props:{data:null},setup(e){return(a,o)=>{const l=N("a-image");return y(),$("div",Be,[c(l,{width:40,height:40,src:e.data.picture},null,8,["src"]),w("div",Se,[w("div",ze,j(e.data.name),1),w("div",Ie,j(e.data.description),1)])])}}});const je=z(Ve,[["__scopeId","data-v-3b93b2fa"]]),Le={class:"page-container"},Ne=C({__name:"index",setup(e){const a=T([{name:"name",component:"Input",label:"工程名称",formItemProps:{labelColFlex:"100px"}},{name:"principalId",component:"UserPicker",label:"工程负责人"},{name:"code",component:"Input",label:"工程编码"},{name:"type",component:"Select",label:"工程类型",props:{options:[{label:"土木工程",value:"1"},{label:"水利工程",value:"2"}]}},{name:"status",component:"Select",label:"工程状态",props:{options:[{label:"正常",value:1},{label:"异常",value:0}]}},{name:"createTime",component:"RangePicker",label:"建档时间",props:{format:"YYYY-MM-DD",placeholder:["开始时间","结束时间"]}}]),o=_(()=>[{type:"primary",status:"danger",disabled:k.size(t.value)===0,onClick:()=>u.onDelect(t.value),text:"批量删除"},{type:"primary",onClick:u.onCreate,text:"新增工程"}]),l=[{title:"工程简介",width:200,render:n=>{const r={name:n.name,picture:n.picture,description:n.address};return c(je,{data:r},null)}},{title:"工程负责人",width:150,render:n=>c(me,{data:n.principal},null)},{title:"工程编码",align:"center",render:n=>c(oe,{color:"arcoblue"},{default:()=>[n.code]})},{title:"工程类型",align:"center",dataIndex:"type"},{title:"所属机构",align:"center",dataIndex:"organization"},{title:"工程状态",align:"center",dataIndex:"status",render:n=>{const r=n.status===1?"success":"normal",g=n.status===1?"正常":"异常";return c(se,{status:r,text:g},null)}},{title:"建档时间",align:"center",dataIndex:"createTime"},{title:"操作",align:"center",width:150,render:n=>c(M,{data:[{type:"text",text:"编辑",onClick:()=>u.onEdit(n)},{type:"text",text:"删除",status:"danger",onClick:()=>u.onDelect([n.id])}]},null)}],{selected:t,loading:i,dataSource:d,search:p,pagination:f,run:m}=he(ue),u={onDelect:n=>{Pe({title:"确认删除",content:`确定要删除这${k.size(n)}条报告吗?`,onBeforeOk:async()=>(await new Promise(r=>setTimeout(r,1e3)),!0)})},onCreate:async()=>{await F(R)&&m()},onEdit:async n=>{await F(R,{id:n.id})&&m()}};return(n,r)=>{const g=$e,P=ke,v=K;return y(),$("div",Le,[c(v,{title:"工程项目列表"},{default:x(()=>[c(g,{modelValue:s(p),"onUpdate:modelValue":r[0]||(r[0]=h=>S(p)?p.value=h:null),"label-width":"70px",configs:a,query:s(m)},null,8,["modelValue","configs","query"]),c(M,{data:s(o)},null,8,["data"]),c(P,{selectedKeys:s(t),"onUpdate:selectedKeys":r[1]||(r[1]=h=>S(t)?t.value=h:null),"row-key":"id",selection:!0,loading:s(i),columns:l,data:s(d),pagination:s(f)},null,8,["selectedKeys","loading","data","pagination"])]),_:1})])}}});export{Ne as default};
