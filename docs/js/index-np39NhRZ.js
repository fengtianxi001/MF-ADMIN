import{d as f,h as b,o as g,c as h,i as D,V as M,f as d,j as r,D as S,a1 as $,ae as k,ag as q,aa as p,b as E,af as v,q as C,K as P}from"./vendor-RGK81Rd9.js";import"./index-awFttPXd.js";import{e as T,_ as F,b as x,a as R,u as U,d as y,f as W,B as N}from"./secretHierarchyEnum-jbaofLgQ.js";import{a as I,D as O}from"./deviceCategoryEnum-upQNdLAM.js";import{u as z,a as B}from"./useModalForm-psK_Mvxo.js";const V=f({__name:"BaseModalForm",props:{title:{},loading:{type:Boolean},modelValue:{},configs:{},onBeforeConfirm:{},layout:{},labelWidth:{},formProps:{}},emits:["update:modelValue"],setup(c,{expose:s,emit:l}){const n=c,o=l,i=b({get(){return n.modelValue},set(e){o("update:modelValue",e)}}),{form:u,validate:m}=z();return s({form:u,validate:m}),(e,a)=>(g(),h(F,{title:e.title,onBeforeConfirm:e.onBeforeConfirm,loading:e.loading,"body-style":{padding:"20px 15px 0px"}},{default:D(()=>[M(e.$slots,"default"),d(r(T),{ref_key:"form",ref:u,modelValue:i.value,"onUpdate:modelValue":a[0]||(a[0]=t=>i.value=t),"auto-label-width":"",size:"small",configs:e.configs,loading:e.loading,layout:e.layout,labelWidth:e.labelWidth,formProps:e.formProps},null,8,["modelValue","configs","loading","layout","labelWidth","formProps"])]),_:3},8,["title","onBeforeConfirm","loading"]))}}),w=f({__name:"editor",props:{mode:{},record:{}},setup(c){const s=c,{form:l,dataSource:n,loading:o,validate:i}=B(),u=b(()=>[{label:"设备编号",name:"code",span:12,component:"Input",required:!0},{label:"设备名称",name:"name",span:12,component:"Input",required:!0},{label:"设备密级",name:"security",span:12,component:"Select",required:!0,props:{options:[...x]}},{label:"设备类别",name:"category",span:12,component:"Select",required:!0,props:{options:[...I]}},{label:"购置时间",name:"purchaseTime",span:12,component:"DatePicker",required:!0},{label:"入库人",name:"warehouse",span:12,component:"Input",required:!0},{label:"入库时间",name:"warehouseTime",span:12,component:"DatePicker",required:!0},{label:"设备型号",name:"model",span:12,component:"Input"},{label:"设备品牌",name:"brand",span:12,component:"Input"},{label:"设备序号",name:"sequence",span:12,component:"Input"},{label:"生产厂商",name:"manufacturer",span:12,component:"Input"}]),m=async()=>await i()?!1:(q.success("操作成功"),!0);return S(()=>{$(()=>{s.mode==="edit"&&(n.value={...s.record})})}),(e,a)=>(g(),h(r(V),{ref_key:"form",ref:l,modelValue:r(n),"onUpdate:modelValue":a[0]||(a[0]=t=>k(n)?n.value=t:null),width:"600px","label-width":"80px","label-align":"left",configs:u.value,loading:r(o),onBeforeConfirm:m},null,8,["modelValue","configs","loading"]))}}),A=f({__name:"batchEditor",setup(c){const{form:s,dataSource:l,loading:n,validate:o}=B(),i=b(()=>[{label:"编号前缀",name:"code",span:12,component:"Input",required:!0},{label:"名称前缀",name:"name",span:12,component:"Input",required:!0},{label:"序号前缀",name:"sequence",span:12,component:"Input"},{label:"设备密级",name:"secret",span:12,component:"Select",required:!0,props:{options:[...x]}},{label:"设备类别",name:"category",span:12,component:"Select",required:!0,props:{options:[...I]}},{label:"设备数量",name:"number",span:12,component:"InputNumber",required:!0,props:{min:1}},{label:"购置时间",name:"purchaseTime",span:12,component:"DatePicker",required:!0},{label:"入库人",name:"warehouse",span:12,component:"Input",required:!0},{label:"入库时间",name:"warehouseTime",span:12,component:"DatePicker",required:!0},{label:"设备型号",name:"model",span:12,component:"Input"},{label:"设备品牌",name:"brand",span:12,component:"Input"},{label:"生产厂商",name:"manufacturer",span:12,component:"Input"}]),u=async()=>await o()?!1:(q.success("操作成功"),!0);return(m,e)=>(g(),h(r(V),{ref_key:"form",ref:s,modelValue:r(l),"onUpdate:modelValue":e[0]||(e[0]=a=>k(l)?l.value=a:null),width:"600px","label-width":"100px","label-align":"left",configs:i.value,loading:r(n),onBeforeConfirm:u},null,8,["modelValue","configs","loading"]))}}),j={class:"page"},Q=f({__name:"index",setup(c){const s=R(Array.from({length:1}).map((a,t)=>({id:t,code:`DEV-${t}`,name:`设备名称 ${t}`,security:p.Random.pick([0,1,2,3]),category:p.Random.pick([0,1,2,3,4,5,6]),purchaseTime:p.Random.date("yyyy-MM-dd"),warehouse:p.Random.cname(),warehouseTime:p.Random.date("yyyy-MM-dd"),model:`型号 ${t}`,brand:`品牌 ${t}`,sequence:`ASDJ00012${t}`,manufacturer:`生产厂商 ${t}`}))),{table:l,selected:n,refresh:o}=U(),i=[{label:"设备编号",name:"code",component:"Input"},{label:"设备名称",name:"name",component:"Input"},{label:"设备型号",name:"model",component:"Input"},{label:"设备类别",name:"category",component:"Select",props:{options:[...I]}}],u=b(()=>[{text:"新增设备",type:"primary",onClick:()=>e.onCreate()},{text:"批量新增",type:"primary",onClick:()=>e.onBatchCreate()},{text:"导入",type:"primary",onClick:()=>e.onImport()},{text:"导出",type:"primary",onClick:()=>e.onExport()},{text:"打印标签",type:"primary",disabled:n.value.length===0,onClick:()=>e.onPrint()},{text:"批量删除",type:"primary",status:"danger",disabled:n.value.length===0,onClick:()=>e.onDelete(n.value)}]),m=[{title:"设备编号",dataIndex:"code",align:"left"},{title:"设备名称",dataIndex:"name",align:"center"},{title:"设备型号",dataIndex:"model",align:"center"},{title:"设备类别",dataIndex:"category",align:"center",render:({record:a})=>O[a.category]},{title:"入库人",dataIndex:"warehouse",align:"center"},{title:"操作",align:"center",width:160,render:({record:a})=>d(P,{size:10},{default:()=>[d(v,{onClick:()=>e.onEdit(a)},{default:()=>[C("编辑")]}),d(v,{onClick:()=>e.onDelete([a.id])},{default:()=>[C("删除")]})]})}],e={onCreate:async()=>{await y(w,{mode:"create",title:"设备登记"})&&o()},onEdit:async a=>{await y(w,{mode:"edit",title:"设备登记信息修改",record:a})&&o()},onBatchCreate:async()=>{await y(A,{title:"设备批量登记"})&&o()},onExport:()=>{},onImport:()=>{},onPrint:()=>{},onDelete:async a=>{await W("删除",async()=>userDelete(record.id))&&o()}};return(a,t)=>(g(),E("div",j,[d(r(N),{selected:r(n),"onUpdate:selected":t[0]||(t[0]=_=>k(n)?n.value=_:null),ref_key:"table",ref:l,title:"设备登记列表","row-key":"code",selection:"checkbox",service:r(s),"table-filter":i,"table-operates":u.value,"table-columns":m},null,8,["selected","service","table-operates"])]))}});export{Q as default};
